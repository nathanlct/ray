(this["webpackJsonpray-dashboard-client"]=this["webpackJsonpray-dashboard-client"]||[]).push([[4],{109:function(e,t,n){e.exports=n.p+"static/media/logo.00a46976.svg"},145:function(e,t,n){e.exports=n(146)},146:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n.n(a),o=n(14),c=n.n(o),l=(n(151),n(89));c.a.render(r.a.createElement(l.b,null),document.getElementById("root"))},53:function(e,t,n){"use strict";n.d(t,"a",(function(){return o})),n.d(t,"b",(function(){return c}));var a=n(99),r=n.n(a),o=function(e){return e.startsWith("/")?e.slice(1):e},c=function(e,t){return r.a.get(o(e),t)}},89:function(e,t,n){"use strict";n.d(t,"a",(function(){return Ga})),n.d(t,"c",(function(){return _a}));var a,r=n(6),o=n(245),c=n(244),l=n(0),i=n.n(l),u=n(16),s=n(81),m=n(51),d=n(12),p=n.n(d),f=n(17),b=n(223),g=n(251),h=n(128),v=n(235),E=n(247),y=n(241),j=n(53),O=function(){var e=Object(f.a)(p.a.mark((function e(t,n){var a,r,o,c,l,i,u;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=Object.entries(n).map((function(e){return e.join("=")})).join("&"),r=[Object(j.a)(t),a].filter((function(e){return e})).join("?"),e.next=4,fetch(r);case 4:return o=e.sent,e.next=7,o.json();case 7:if(c=e.sent,l=c.result,i=c.msg,u=c.data,l){e.next=11;break}throw Error(i);case 11:return e.abrupt("return",u);case 12:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}();function k(e){return e.state!==a.Infeasible&&e.state!==a.PendingResources}!function(e){e.Infeasible="INFEASIBLE",e.PendingResources="PENDING_RESOURCES",e.DependenciesUnready="PENDING",e.PendingCreation="CREATING",e.Alive="ALIVE",e.Restarting="RESTARTING",e.Dead="DEAD"}(a||(a={}));var x,C=function(e,t){return O("/node_errors",{nodeIp:e,pid:null!==t&&void 0!==t?t:""})},S=function(e,t){return O("/node_logs",{ip:e,pid:null!==t&&void 0!==t?t:""})},N=function(e,t,n){return O("/api/launch_profiling",{node_id:e,pid:t,duration:n})},w=function(e){var t=encodeURIComponent(Object(j.a)("/api/get_profiling_info?profiling_id=".concat(e)));return Object(j.a)("/speedscope/index.html#profileURL=".concat(t))},T=function(){return O("/tune/info",{})},F=function(e){return O("/tune/set_experiment",{experiment:e})},R=function(){return O("/tune/enable_tensorboard",{})},I=function(){var e=Object(f.a)(p.a.mark((function e(t){return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",O("/memory/memory_table",{groupBy:t}));case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),A=function(e){return O("/memory/set_fetch",{shouldFetch:e})},L=n(18),M=n(15),P=n(21),D=n(20),W=n(4),z=function(e){Object(P.a)(n,e);var t=Object(D.a)(n);function n(){return Object(L.a)(this,n),t.apply(this,arguments)}return Object(M.a)(n,[{key:"render",value:function(){var e=this.props,t=e.classes,n=e.lastUpdatedAt,a=e.error;return i.a.createElement("div",{className:t.root},null!==n&&i.a.createElement(h.a,{className:t.lastUpdated},"Last updated: ",new Date(n).toLocaleString()),null!==a&&i.a.createElement(h.a,{className:t.error},a))}}]),n}(i.a.Component),B=Object(u.b)((function(e){return{lastUpdatedAt:e.dashboard.lastUpdatedAt,error:e.dashboard.error}}))(Object(W.a)((function(e){return Object(g.a)({root:{marginTop:e.spacing(2)},lastUpdated:{color:e.palette.text.secondary,fontSize:"0.8125rem",textAlign:"center"},error:{color:e.palette.error.main,fontSize:"0.8125rem",textAlign:"center"}})}))(z)),U=n(246),G=n(182),_=n(183),H=n(185),V=n(186),q=n(253),J=n(250),K=n(248),Y=function(e,t,n){return t[n]<e[n]?-1:t[n]>e[n]?1:0},X=function(e,t,n){var a=n(e),r=n(t);return r<a?-1:r>a?1:0},Q=function(e,t){return function(n,a){return"desc"===e?X(n,a,t):-X(n,a,t)}},Z=function(e,t){var n=e.map((function(e,t){return[e,t]}));return n.sort((function(e,n){var a=t(e[0],n[0]);return 0!==a?a:e[1]-n[1]})),n.map((function(e){return e[0]}))},$=n(31),ee=function(e){if(0===e.length)return 0;var t,n=0,a=0,r=Object($.a)(e);try{for(r.s();!(t=r.n()).done;){var o=t.value,c=o.weight;n+=c*o.value,a+=c}}catch(l){r.e(l)}finally{r.f()}return n/a},te=function(e){return e.reduce((function(e,t){return e+t}),0)},ne=n(127),ae=n(180),re=n(224),oe=n(114),ce=n.n(oe),le=n(115),ie=n.n(le),ue=function(e){var t=e.onClick;return i.a.createElement(ce.a,{onClick:t})},se=function(e){var t=e.onClick;return i.a.createElement(ie.a,{onClick:t})},me=n(225),de=Object(b.a)({tooltipLabel:{textDecorationLine:"underline",textDecorationColor:"#a6c3e3",textDecorationThickness:"1px",textDecorationStyle:"dotted",cursor:"help"}}),pe=function(e){var t=e.label,n=e.datum,a=e.tooltip,r=de(),o=i.a.createElement(re.a,{container:!0,item:!0,xs:12},i.a.createElement(re.a,{item:!0,xs:6},i.a.createElement(U.a,{className:a&&r.tooltipLabel},t)),i.a.createElement(re.a,{item:!0,xs:6},i.a.createElement("span",null,n)));return a?i.a.createElement(me.a,{title:a},o):o},fe=n(8),be=n(29),ge=n(226),he=Object(b.a)((function(e){return Object(g.a)({root:{borderColor:e.palette.divider,borderStyle:"solid",borderWidth:1,display:"flex",flexGrow:1},inner:{paddingLeft:e.spacing(1),paddingRight:e.spacing(1)}})})),ve=function(e){var t=e.percent,n=e.text,a=he(),o=Math.max(Math.min(t,100),0),c=[0,255,0],l=c,u=function(e,t,n){var a=Object(r.a)(e,3),o=a[0],c=a[1],l=a[2],i=Object(r.a)(t,3);return[o*(1-n)+i[0]*n,c*(1-n)+i[1]*n,l*(1-n)+i[2]*n]}(c,[255,0,0],o/100),s="\n    linear-gradient(\n      to right,\n      rgba(".concat(l.join(","),", ").concat(.2,") 0%,\n      rgba(").concat(u.join(","),", ").concat(.2,") ").concat(o,"%,\n      transparent ").concat(o,"%\n    )\n  ");return i.a.createElement("span",{className:a.root},i.a.createElement("span",{className:a.inner,style:{background:s,flexGrow:1}},i.a.createElement(h.a,{align:"center"},n)))},Ee=a.Alive,ye=a.Dead,je=a.PendingCreation,Oe=a.Restarting,ke=a.DependenciesUnready,xe=a.Infeasible,Ce=a.PendingResources,Se=Object(b.a)((function(e){return Object(g.a)({infeasible:{color:e.palette.error.light},pendingResources:{color:e.palette.warning.light},unknown:{color:e.palette.warning.light},creating:{color:e.palette.success.light},alive:{color:e.palette.success.dark},restarting:{color:e.palette.warning.light},dead:{color:"#cccccc"},tooltip:{cursor:"help"}})})),Ne=(x={},Object(fe.a)(x,Ee,"The actor is alive and handling remote calls."),Object(fe.a)(x,ye,"The actor is dead and will not be restarted anymore."),Object(fe.a)(x,xe,"The actor cannot be created because of insufficient resources in the cluster. Please examine its resource constraints to make sure they are correct or add additional compute to your cluster."),Object(fe.a)(x,Oe,"The actor died and is restarting."),Object(fe.a)(x,je,"The actor's resources and other dependencies are ready, and the Ray backend is processing its creation."),Object(fe.a)(x,ke,"The actor is pending creation because it is waiting for one or more of its initialization arguments to be ready."),Object(fe.a)(x,Ce,"The actor is pending resources, such as GPU, Memory, or CPU. It will be created when they become available."),x),we=function(e){var t,n=e.state,a=e.variant,r=e.showTooltip,o=Se(),c=null!==a&&void 0!==a?a:"body1";switch(n){case xe:t=i.a.createElement(h.a,{variant:c,className:o.infeasible},"Infeasible");break;case Ce:t=i.a.createElement(h.a,{variant:c,className:o.pendingResources},"Pending Resources");break;case je:t=i.a.createElement(h.a,{variant:c,className:o.creating},"Creating");break;case ke:t=i.a.createElement(h.a,{variant:c,className:o.creating},"Dependencies Unready");break;case Ee:t=i.a.createElement(h.a,{variant:c,className:o.alive},"Alive");break;case Oe:t=i.a.createElement(h.a,{variant:c,className:o.restarting},"Restarting");break;case ye:t=i.a.createElement(h.a,{variant:c,className:o.dead},"Dead")}return r?i.a.createElement(me.a,{className:o.tooltip,title:Ne[n]},t):t},Te="https://docs.ray.io/en/master/memory-management.html#debugging-using-ray-memory",Fe=Object(b.a)((function(e){return{divider:{width:"100%",margin:"0 auto"},actorTitleWrapper:{marginTop:e.spacing(1),marginBottom:e.spacing(1),fontWeight:"bold",fontSize:"130%"},detailsPane:{margin:e.spacing(1)}}})),Re=function(e){var t,n,a,o,c=e.actor,l=Fe(),u=function(e){var t,n,a,o,c,l,i,u,s,m;return k(e)?[{label:"Resources",value:e.usedResources&&Object.entries(e.usedResources).length>0&&Object.entries(e.usedResources).sort((function(e,t){return e[0].localeCompare(t[0])})).map((function(e){var t=Object(r.a)(e,2),n=t[0],a=t[1];return"".concat(te(a.resourceSlots.map((function(e){return e.allocation})))," ").concat(n)})).join(", ")},{label:"Number of pending tasks",value:null!==(t=null===(n=e.taskQueueLength)||void 0===n?void 0:n.toLocaleString())&&void 0!==t?t:"0",tooltip:"The number of tasks that are currently pending to execute on this actor. If this number remains consistently high, it may indicate that this actor is a bottleneck in your application."},{label:"Number of executed tasks",value:null!==(a=null===(o=e.numExecutedTasks)||void 0===o?void 0:o.toLocaleString())&&void 0!==a?a:"0",tooltip:"The number of tasks this actor has executed throughout its lifetimes."},{label:"Number of ObjectRefs in scope",value:null!==(c=null===(l=e.numObjectRefsInScope)||void 0===l?void 0:l.toLocaleString())&&void 0!==c?c:"0",tooltip:"The number of ObjectRefs that this actor is keeping in scope via its internal state. This does not imply that the objects are in active use or colocated on the node with the actor "+"currently. This can be useful for debugging memory leaks. See the docs at ".concat(Te," ")+"for more information."},{label:"Number of local objects",value:null!==(i=null===(u=e.numLocalObjects)||void 0===u?void 0:u.toLocaleString())&&void 0!==i?i:"0",tooltip:"The number of small objects that this actor has stored in its local in-process memory store. This can be useful for "+"debugging memory leaks. See the docs at ".concat(Te," for more information")},{label:"Object store memory used (MiB)",value:null!==(s=null===(m=e.usedObjectStoreMemory)||void 0===m?void 0:m.toLocaleString())&&void 0!==s?s:"0",tooltip:"The total amount of memory that this actor is occupying in the Ray object store. If this number is increasing without bounds, you might have a memory leak. See "+"the docs at: ".concat(Te," for more information.")}]:[{label:"Actor ID",value:e.actorId,tooltip:""},{label:"Required resources",value:e.requiredResources&&Object.entries(e.requiredResources).length>0&&Object.entries(e.requiredResources).sort((function(e,t){return e[0].localeCompare(t[0])})).map((function(e){var t=Object(r.a)(e,2),n=t[0],a=t[1];return"".concat(a.toLocaleString()," ").concat(n)})).join(", "),tooltip:""}]}(c);return i.a.createElement(i.a.Fragment,null,i.a.createElement("div",{className:l.actorTitleWrapper},i.a.createElement("div",null,c.actorClass),i.a.createElement(we,{state:c.state})),k(c)&&i.a.createElement(re.a,{container:!0,spacing:3,className:l.detailsPane},i.a.createElement(re.a,{container:!0,item:!0,xs:6},i.a.createElement(re.a,{item:!0,xs:4},i.a.createElement(h.a,null,"CPU Usage")),i.a.createElement(re.a,{item:!0,xs:4},i.a.createElement(ve,{percent:null!==(t=null===(n=c.processStats)||void 0===n?void 0:n.cpuPercent)&&void 0!==t?t:0,text:"".concat(null!==(a=null===(o=c.processStats)||void 0===o?void 0:o.cpuPercent)&&void 0!==a?a:0,"%")})),i.a.createElement(re.a,{item:!0,xs:4})),c.gpus.length>0&&i.a.createElement(re.a,{container:!0,item:!0,xs:6},i.a.createElement(re.a,{item:!0,xs:12},i.a.createElement(h.a,null,"GPU Usage")),c.gpus.map((function(e){var t=e.utilizationGpu?i.a.createElement(ve,{percent:100*e.utilizationGpu,text:"".concat(100*e.utilizationGpu,"%")}):i.a.createElement(h.a,{color:"textSecondary",component:"span",variant:"inherit"},"N/A");return i.a.createElement(i.a.Fragment,{key:e.uuid},i.a.createElement(re.a,{item:!0,xs:4},"[".concat(e.name,"]")),i.a.createElement(re.a,{item:!0,xs:4},t),i.a.createElement(re.a,{item:!0,xs:4}))})))),i.a.createElement(ge.a,{className:l.divider}),i.a.createElement(re.a,{container:!0,className:l.detailsPane},u.map((function(e){var t=e.label,n=e.value,a=e.tooltip;return n&&n.length>0&&i.a.createElement(pe,{key:t,label:t,datum:n,tooltip:a})}))))},Ie=Object(b.a)((function(e){return Object(g.a)({root:{borderColor:e.palette.divider,borderStyle:"solid",borderWidth:1,marginTop:e.spacing(2),padding:e.spacing(2),width:"100%"},title:{color:e.palette.text.secondary,fontSize:"0.75rem"},action:{color:e.palette.primary.main,textDecoration:"none","&:hover":{cursor:"pointer"}},infeasible:{color:e.palette.error.main},pendingResources:{color:e.palette.secondary.main},webuiDisplay:{fontSize:"0.875rem"},inlineHTML:{fontSize:"0.875rem",display:"inline"}})})),Ae=function(e){var t=e.actor,n=Object(l.useState)({}),o=Object(r.a)(n,2),c=o[0],u=o[1],s=Ie(),m=function(e){return Object(f.a)(p.a.mark((function n(){var r,o;return p.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(t.state!==a.Alive){n.next=8;break}return n.next=3,N(t.nodeId,t.pid,e);case 3:return r=n.sent,u(Object(be.a)(Object(be.a)({},c),{},Object(fe.a)({},r,{startTime:Date.now(),latestResponse:null}))),o=function(){var e=Object(f.a)(p.a.mark((function e(){var t;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,O("/api/check_profiling_status",{profiling_id:r});case 2:t=e.sent,u(Object(be.a)(Object(be.a)({},c),{},Object(fe.a)({},r,Object(be.a)(Object(be.a)({},c[r]),{},{latestResponse:t})))),"pending"===t.status&&setTimeout(o,1e3);case 5:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),n.next=8,o();case 8:case"end":return n.stop()}}),n)})))},d=[];return k(t)&&t.webuiDisplay&&(d=Object.keys(t.webuiDisplay).sort().map((function(e,n,a){var r=t.webuiDisplay[e],o=JSON.parse(r),c=o.message;return"html"===o.dtype&&(c=i.a.createElement("div",{className:s.inlineHTML,dangerouslySetInnerHTML:{__html:c}})),""===e?i.a.createElement(h.a,{className:s.webuiDisplay},"\xa0 \xa0 ",c):i.a.createElement(h.a,{className:s.webuiDisplay},"\xa0 \xa0 ",e,": ",c)}))),i.a.createElement("div",{className:s.root},i.a.createElement(h.a,{className:s.title},k(t)?i.a.createElement(i.a.Fragment,null,"Actor ",t.actorId," (Profile for",[10,30,60].map((function(e){return i.a.createElement(i.a.Fragment,{key:e}," ",i.a.createElement("span",{className:s.action,onClick:m(e)},e,"s"))})),")"," ",t.state===a.Alive&&i.a.createElement("span",{className:s.action,onClick:function(){var e,n,r;t.state===a.Alive&&(e=t.actorId,n=t.ipAddress,r=t.port,O("/logical/kill_actor",{actorId:e,ipAddress:n,port:r}))}},"Kill Actor"),Object.entries(c).map((function(e){var t=Object(r.a)(e,2),n=t[0],a=t[1],o=a.startTime,c=a.latestResponse;return null!==c&&i.a.createElement(i.a.Fragment,{key:n},"(","pending"===c.status?"Profiling for ".concat(Math.round((Date.now()-o)/1e3),"s..."):"finished"===c.status?i.a.createElement("a",{className:s.action,href:w(n),rel:"noopener noreferrer",target:"_blank"},"Profiling result"):"error"===c.status?"Profiling error: ".concat(c.error.trim()):void 0,")"," ")}))):t.state===a.Infeasible?i.a.createElement("span",{className:s.infeasible},t.actorClass," cannot be created because the Ray cluster cannot satisfy its resource requirements."):i.a.createElement("span",{className:s.pendingResources},t.actorClass," is pending until resources are available.")),i.a.createElement(Re,{actor:t}),k(t)&&i.a.createElement(i.a.Fragment,null,d.length>0&&i.a.createElement(i.a.Fragment,null,d)))},Le=function(e){return"".concat(e,"s")},Me=Object(ne.a)(U.a)({textAlign:"center"}),Pe=Object(b.a)((function(e){return Object(g.a)({container:{margin:e.spacing(1),padding:e.spacing(1),marginLeft:e.spacing(2)},title:{margin:e.spacing(1)},actorEntry:{width:"100%"}})})),De=function(e){var t=e.actorGroup,n=e.title,o=Pe(),c=Object(l.useState)(!1),u=Object(r.a)(c,2),s=u[0],m=u[1],d=function(){return m(!s)},p=t.entries.map((function(e,t){var n;return i.a.createElement(U.a,{component:"div",className:o.actorEntry,key:null!==(n=e.actorId)&&void 0!==n?n:t},i.a.createElement(Ae,{actor:e}))})),f=a.Alive,b=a.PendingResources,g=a.Infeasible,v=t.summary;return i.a.createElement(ae.a,{className:o.container},i.a.createElement(U.a,{display:"block",className:o.title},i.a.createElement(h.a,{variant:"h5"},n)),i.a.createElement(re.a,{container:!0,xs:12,spacing:2},i.a.createElement(re.a,{container:!0,item:!0,xs:5,className:o.title},g in v.stateToCount&&i.a.createElement(pe,{label:i.a.createElement(we,{state:g,variant:"body1",showTooltip:!0}),datum:v.stateToCount[g]}),i.a.createElement(pe,{label:i.a.createElement(we,{state:f,variant:"body1",showTooltip:!0}),datum:f in v.stateToCount?v.stateToCount[f]:0}),i.a.createElement(pe,{label:i.a.createElement(we,{state:b,variant:"body1",showTooltip:!0}),datum:b in v.stateToCount?v.stateToCount[b]:0})),i.a.createElement(re.a,{container:!0,item:!0,xs:5,className:o.title},i.a.createElement(pe,{label:"Mean Lifetime",datum:Le(v.avgLifetime)}),i.a.createElement(pe,{label:"Max Lifetime",datum:Le(v.maxLifetime)}),i.a.createElement(pe,{label:"Executed Tasks",datum:v.numExecutedTasks}))),s?i.a.createElement(i.a.Fragment,null,i.a.createElement(U.a,null,p),i.a.createElement(Me,null,i.a.createElement(ue,{onClick:d}))):i.a.createElement(Me,null,i.a.createElement(se,{onClick:d})))},We=function(e){var t=e.actorGroups,n=function(e){var t;return null!==(t=e.summary.stateToCount[a.Infeasible])&&void 0!==t?t:0},o=te(Object.values(t).map(n)),c=Object(l.useState)(o>0),u=Object(r.a)(c,2),s=u[0],m=u[1],d=Z(Object.entries(t),(function(e,t){var a=Object(r.a)(e,2),o=a[0],c=a[1],l=Object(r.a)(t,2),i=l[0],u=l[1],s=n(c),m=n(u);return s!==m?s>m?-1:1:o>i?1:-1})).map((function(e){var t=Object(r.a)(e,2),n=t[0],a=t[1];return i.a.createElement(De,{actorGroup:a,title:n,key:"acg-".concat(n)})}));return i.a.createElement(i.a.Fragment,null,i.a.createElement(J.a,{open:s},i.a.createElement(K.a,{severity:"warning",onClose:function(){return m(!1)}},"There are one or more actors that cannot currently be created due to insufficient cluster resources. These have been sorted to the top of the list. If you are using autoscaling functionality, you may ignore this message.")),d)},ze=Object(b.a)((function(e){return Object(g.a)({container:{marginBottom:e.spacing(1)}})})),Be=function(e){return e.dashboard.actorGroups},Ue=function(){var e=Object(l.useState)(""),t=Object(r.a)(e,2),n=t[0],a=t[1],o=Object(q.a)(n,500),c=Object(r.a)(o,1)[0],s=ze(),m=Object(u.d)(Be);if(!m)return i.a.createElement(h.a,{color:"textSecondary"},"Loading...");if(0===Object.keys(m).length)return i.a.createElement(h.a,{color:"textSecondary"},"Finished loading, but have found no actors yet.");var d=""===c?Object.entries(m):Object.entries(m).filter((function(e){var t=Object(r.a)(e,2),n=t[0];t[1];return function(e,t){var n=t.toLowerCase();return-1!==e.toLowerCase().search(n)}(n,c)}));return i.a.createElement(U.a,{className:s.container},0===d.length?i.a.createElement(h.a,{color:"textSecondary"},"No actors found."):i.a.createElement(i.a.Fragment,null,i.a.createElement(G.a,null,i.a.createElement(_.a,{htmlFor:"actor-name-filter"},"Actor Search"),i.a.createElement(H.a,{id:"actor-name-filter","aria-describedby":"actor-name-helper-text",value:n,onChange:function(e){return a(e.target.value)}}),i.a.createElement(V.a,{id:"actor-name-helper-text"},"Search for an actor by name")),i.a.createElement(We,{actorGroups:Object.fromEntries(d)})))},Ge=n(232),_e=n(191),He=n(234),Ve=n(120),qe=n.n(Ve),Je=n(119),Ke=n.n(Je),Ye=n(118),Xe=n.n(Ye),Qe=n(74),Ze=Object(Qe.b)({name:"dashboard",initialState:{actorGroups:null,tab:0,rayConfig:null,nodeInfo:null,tuneInfo:null,tuneAvailability:null,lastUpdatedAt:null,error:null,memoryTable:null,shouldObtainMemoryTable:!1},reducers:{setTab:function(e,t){e.tab=t.payload},setRayConfig:function(e,t){e.rayConfig=t.payload},setNodeInfo:function(e,t){e.nodeInfo=t.payload.nodeInfo,e.lastUpdatedAt=Date.now()},setActorGroups:function(e,t){e.actorGroups=t.payload.actorGroups},setTuneInfo:function(e,t){e.tuneInfo=t.payload.result,e.lastUpdatedAt=Date.now()},setTuneAvailability:function(e,t){e.tuneAvailability=t.payload.result,e.lastUpdatedAt=Date.now()},setError:function(e,t){e.error=t.payload},setMemoryTable:function(e,t){e.memoryTable=t.payload.memoryTable},setShouldObtainMemoryTable:function(e,t){e.shouldObtainMemoryTable=t.payload}}}),$e=Ze.actions,et=Ze.reducer,tt=function(e,t){return"".concat((e/("mebibyte"===t?Math.pow(1024,2):Math.pow(1024,3))).toFixed(1)," ").concat("mebibyte"===t?"MiB":"GiB")},nt=function(e,t,n,a){var r=tt(e,n),o=tt(t,n),c=100*e/t,l="".concat(r," / ").concat(o);return a?"".concat(l," (").concat(c.toFixed(0),"%)"):l},at=function(e){var t=Math.floor(e)%60,n=Math.floor(e/60)%60,a=Math.floor(e/60/60)%24,r=Math.floor(e/60/60/24),o=function(e){return e.toString().padStart(2,"0")};return[r?"".concat(r,"d"):"","".concat(o(a),"h"),"".concat(o(n),"m"),"".concat(o(t),"s")].join(" ")},rt=function(e){try{return(e.toString().split(".")[1].length||0)<=3?e.toString():Math.abs(e.valueOf())>=1?e.toPrecision(5):e.toExponential()}catch(t){return e.toString()}},ot=Object(b.a)((function(e){return Object(g.a)({expandCollapseIcon:{color:e.palette.text.secondary,fontSize:"1.5em",verticalAlign:"middle"},container:{padding:e.spacing(1),margin:e.spacing(1)}})})),ct=function(e){var t=e.memoryTableSummary,n=ot(),a=[["Total Local Reference Count","".concat(t.totalLocalRefCount)],["Pinned in Memory Count","".concat(t.totalPinnedInMemory)],["Total Used by Pending Tasks Count","".concat(t.totalUsedByPendingTask)],["Total Captured in Objects Count","".concat(t.totalCapturedInObjects)],["Total Memory Used by Objects","".concat(tt(t.totalObjectSize,"mebibyte"))],["Total Actor Handle Count","".concat(t.totalActorHandles)]];return i.a.createElement(re.a,{container:!0,className:n.container},a.map((function(e){var t=Object(r.a)(e,2),n=t[0],a=t[1];return i.a.createElement(pe,{key:n,label:n,datum:a})})))},lt=n(230),it=n(231),ut=n(228),st=n(229),mt=n(252),dt=n(227),pt=Object(ne.a)(dt.a)((function(e){return{padding:e.theme.spacing(1),textAlign:"center"}})),ft=(Object(ne.a)(dt.a)((function(e){return{padding:e.theme.spacing(1),textAlign:"center",cursor:"pointer"}})),Object(b.a)((function(e){return Object(g.a)({visuallyHidden:{border:0,clip:"rect(0 0 0 0)",height:1,margin:-1,overflow:"hidden",padding:0,position:"absolute",top:20,width:1}})}))),bt=function(e){var t=e.order,n=e.orderBy,a=e.onRequestSort,r=e.headerInfo,o=e.firstColumnEmpty,c=ft();return i.a.createElement(ut.a,null,i.a.createElement(st.a,null,o&&i.a.createElement(pt,null),r.map((function(e){return e.sortable?i.a.createElement(pt,{key:e.label,align:e.numeric?"right":"left",sortDirection:n===e.id&&t},i.a.createElement(mt.a,{active:n===e.id,direction:n===e.id?t:"asc",onClick:(r=e.id,function(e){a(e,r)})},e.label,n===e.id?i.a.createElement("span",{className:c.visuallyHidden},"desc"===t?"sorted descending":"sorted ascending"):null)):i.a.createElement(pt,{key:e.label,align:e.numeric?"right":"left"},e.label);var r}))))},gt=function(e){var t=e.memoryTableEntry,n=-1===t.objectSize?"?":tt(t.objectSize,"mebibyte"),a=[t.nodeIpAddress,t.pid,t.type,t.objectRef,n,t.referenceType,t.callSite];return i.a.createElement(st.a,{hover:!0},a.map((function(e,t){return i.a.createElement(pt,{key:"".concat(t)},e)})))},ht=Object(b.a)((function(e){return Object(g.a)({container:{margin:e.spacing(1),padding:e.spacing(1)},cell:{padding:e.spacing(1),textAlign:"center"}})})),vt=[{id:"nodeIpAddress",label:"IP Address",numeric:!1,sortable:!0},{id:"pid",label:"PID",numeric:!1,sortable:!0},{id:"type",label:"Type",numeric:!1,sortable:!0},{id:"objectRef",label:"Object Ref",numeric:!1,sortable:!0},{id:"objectSize",label:"Object Size",numeric:!1,sortable:!0},{id:"referenceType",label:"Reference Type",numeric:!1,sortable:!0},{id:"callSite",label:"Call Site",numeric:!1,sortable:!0}],Et=function(e){var t=e.tableEntries,n=ht(),a=i.a.useState("asc"),o=Object(r.a)(a,2),c=o[0],l=o[1],u=i.a.useState(null),s=Object(r.a)(u,2),m=s[0],d=s[1],p=m&&function(e,t){return"desc"===e?function(e,n){return Y(e,n,t)}:function(e,n){return-Y(e,n,t)}}(c,m),f=(p?Z(t,p):t).map((function(e){return i.a.createElement(gt,{memoryTableEntry:e,key:e.objectRef})}));return i.a.createElement(ae.a,{className:n.container,elevation:2},i.a.createElement(lt.a,null,i.a.createElement(bt,{orderBy:m,order:c,onRequestSort:function(e,t){t===m?l("asc"===c?"desc":"asc"):(d(t),l("asc"))},headerInfo:vt,firstColumnEmpty:!1}),i.a.createElement(it.a,null,f)))},yt=Object(ne.a)(U.a)({textAlign:"center"}),jt=Object(b.a)((function(e){return Object(g.a)({container:{marginTop:e.spacing(2),marginBottom:e.spacing(2),paddingTop:e.spacing(2),paddingBottom:e.spacing(1),paddingLeft:e.spacing(2),paddingRight:e.spacing(2)}})})),Ot=function(e){var t=e.groupKey,n=e.groupTitle,a=e.entries,o=e.summary,c=e.initialExpanded,u=e.initialVisibleEntries,s=jt(),m=Object(l.useState)(c),d=Object(r.a)(m,2),p=d[0],f=d[1],b=Object(l.useState)(u),g=Object(r.a)(b,2),h=g[0],v=g[1],E=function(){return f(!p)},y=a.slice(0,h);return i.a.createElement(ae.a,{key:t,className:s.container},n,i.a.createElement(ct,{initialExpanded:!1,memoryTableSummary:o}),p?i.a.createElement(i.a.Fragment,null,i.a.createElement(Et,{tableEntries:y}),i.a.createElement(yt,null,a.length>h&&i.a.createElement(se,{onClick:function(){return v(h+10)}}),i.a.createElement(ue,{onClick:E}))):i.a.createElement(yt,null,i.a.createElement(se,{onClick:E})))},kt=function(e,t){return"node"===t?i.a.createElement(h.a,{variant:"h6"},"Node ".concat(e)):"stack_trace"===t?i.a.createElement(xt,{stackTrace:e}):""===t?i.a.createElement(h.a,{variant:"h6"},"All entries"):i.a.createElement(h.a,{variant:"h6"},"Unknown Group")},xt=function(e){var t=e.stackTrace.split(" | ").map((function(e,t){return i.a.createElement(h.a,{variant:0===t?"h6":"subtitle2",style:{marginLeft:"".concat(t,"em")},key:t},0!==t&&i.a.createElement(Xe.a,null),e)}));return i.a.createElement(U.a,null,t)},Ct=Object(b.a)((function(e){return Object(g.a)({pauseButton:{margin:e.spacing(1),padding:e.spacing(1),float:"right"},select:{minWidth:"7em"}})})),St=function(e){return e.dashboard.memoryTable},Nt=function(e){return 0===Object.keys(e.group).length},wt=function(e){return Math.abs(((new Date).getTime()-e.getTime())/1e3)>10},Tt=function(){var e=Object(u.d)(St),t=Object(u.c)(),n=new Date,a=Object(l.useState)(!1),o=Object(r.a)(a,2),c=o[0],s=o[1],m=c?i.a.createElement(Ke.a,null):i.a.createElement(qe.a,null),d=Ct(),b=Object(l.useState)("node"),g=Object(r.a)(b,2),E=g[0],y=g[1];Object(l.useEffect)((function(){return A(!0),function(){A(!1)}}),[]);var j,O,k=Object(l.useCallback)((j=E,O=function(e){return t($e.setMemoryTable(e))},Object(f.a)(p.a.mark((function e(){var t;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,I(j);case 2:t=e.sent,O(t);case 4:case"end":return e.stop()}}),e)})))),[E]),x=Object(l.useRef)(null);if(Object(l.useEffect)((function(){x.current||c||(k(),x.current=setInterval(k,4e3));return function(){x.current&&(clearInterval(x.current),x.current=null)}}),[c,k,t]),!e||Nt(e)&&!wt(n))return i.a.createElement(h.a,{align:"center",color:"textSecondary",variant:"h3"},i.a.createElement(Ge.a,null)," Loading");if(Nt(e)&&wt(n))return i.a.createElement(h.a,{align:"center",color:"textSecondary",variant:"h3"},"Finished loading, but nothing found.");var C=Object.entries(e.group).sort((function(e,t){return Object(r.a)(e,1)[0]<Object(r.a)(t,1)[0]?-1:1})).map((function(e){var t=Object(r.a)(e,2),n=t[0],a=t[1];return i.a.createElement(Ot,{key:n,groupKey:n,groupTitle:kt(n,E),entries:a.entries,summary:a.summary,initialExpanded:!1,initialVisibleEntries:10})}));return i.a.createElement(U.a,null,i.a.createElement(G.a,null,i.a.createElement(_.a,{shrink:!0,id:"group-by-label"},"Group by"),i.a.createElement(_e.a,{labelId:"group-by-label",value:E,className:d.select,onChange:function(e){return y(e.target.value)},color:"primary",displayEmpty:!0},i.a.createElement(He.a,{value:""},i.a.createElement("em",null,"None")),i.a.createElement(He.a,{value:"node"},"Node IP Address"),i.a.createElement(He.a,{value:"stack_trace"},"Stack Trace"))),i.a.createElement(v.a,{color:"primary",className:d.pauseButton,onClick:function(){x.current&&(clearInterval(x.current),x.current=null),A(!c),s(!c)}},m,c?"Resume Collection":"Pause Collection"),C)},Ft=n(237),Rt=n(249),It=n(13),At=n(236),Lt=n(181),Mt=n(121),Pt=n.n(Mt),Dt=function(e){Object(P.a)(n,e);var t=Object(D.a)(n);function n(){return Object(L.a)(this,n),t.apply(this,arguments)}return Object(M.a)(n,[{key:"render",value:function(){var e=this.props,t=e.classes,n=e.handleClose,a=e.title;return i.a.createElement(At.a,{classes:{paper:t.paper},fullWidth:!0,maxWidth:"md",onClose:n,open:!0,scroll:"body"},i.a.createElement(Lt.a,{className:t.closeButton,onClick:n},i.a.createElement(Pt.a,null)),i.a.createElement(h.a,{className:t.title},a),this.props.children)}}]),n}(i.a.Component),Wt=Object(W.a)((function(e){return Object(g.a)({paper:{padding:e.spacing(3)},closeButton:{position:"absolute",right:e.spacing(1.5),top:e.spacing(1.5),zIndex:1},title:{borderBottomColor:e.palette.divider,borderBottomStyle:"solid",borderBottomWidth:1,fontSize:"1.5rem",lineHeight:1,marginBottom:e.spacing(3),paddingBottom:e.spacing(3)}})}))(Dt),zt=n(49),Bt=n.n(zt),Ut=function(e){Object(P.a)(n,e);var t=Object(D.a)(n);function n(){return Object(L.a)(this,n),t.apply(this,arguments)}return Object(M.a)(n,[{key:"render",value:function(){var e=this.props,t=e.classes,n=e.lines;return i.a.createElement(lt.a,null,i.a.createElement(it.a,null,n.map((function(e,n){return i.a.createElement(st.a,{key:n},i.a.createElement(dt.a,{className:Bt()(t.cell,t.lineNumber),"data-line-number":n+1}),i.a.createElement(dt.a,{className:Bt()(t.cell,t.line)},e))}))))}}]),n}(i.a.Component),Gt=Object(W.a)((function(e){return Object(g.a)({root:{overflowX:"auto"},cell:{borderWidth:0,fontFamily:"SFMono-Regular,Consolas,Liberation Mono,Menlo,monospace",padding:0,"&:last-child":{paddingRight:0}},lineNumber:{color:e.palette.text.secondary,paddingRight:e.spacing(2),textAlign:"right",verticalAlign:"top",width:"1%","&::before":{content:"attr(data-line-number)"}},line:{textAlign:"left",whiteSpace:"pre-wrap"}})}))(Ut),_t=function(e){Object(P.a)(n,e);var t=Object(D.a)(n);function n(){var e;Object(L.a)(this,n);for(var a=arguments.length,r=new Array(a),o=0;o<a;o++)r[o]=arguments[o];return(e=t.call.apply(t,[this].concat(r))).state={result:null,error:null},e}return Object(M.a)(n,[{key:"componentDidMount",value:function(){var e=Object(f.a)(p.a.mark((function e(){var t,n,a,r;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,t=this.props,n=t.nodeIp,a=t.pid,e.next=4,C(n,a);case 4:r=e.sent,this.setState({result:r.errors,error:null}),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(0),this.setState({result:null,error:e.t0.toString()});case 11:case"end":return e.stop()}}),e,this,[[0,8]])})));return function(){return e.apply(this,arguments)}}()},{key:"render",value:function(){var e=this.props,t=e.classes,n=e.clearErrorDialog,a=e.nodeIp,o=this.state,c=o.result,l=o.error;return i.a.createElement(Wt,{handleClose:n,title:"Errors"},null!==l?i.a.createElement(h.a,{color:"error"},l):null===c?i.a.createElement(h.a,{color:"textSecondary"},"Loading..."):Object.entries(c).map((function(e){var n=Object(r.a)(e,2),o=n[0],c=n[1];return i.a.createElement(i.a.Fragment,{key:o},i.a.createElement(h.a,{className:t.header},a," (PID: ",o,")"),c.length>0?c.map((function(e,n){var a=e.message,r=e.timestamp;return i.a.createElement("div",{className:t.error,key:n},i.a.createElement(h.a,{className:t.timestamp},"Error at ",new Date(1e3*r).toLocaleString()),i.a.createElement(Gt,{lines:a.trim().split("\n")}))})):i.a.createElement(h.a,{color:"textSecondary"},"No errors found."))})))}}]),n}(i.a.Component),Ht=Object(W.a)((function(e){return Object(g.a)({header:{lineHeight:1,marginBottom:e.spacing(3),marginTop:e.spacing(3)},error:{backgroundColor:Object(It.c)(e.palette.error.main,.04),borderLeftColor:e.palette.error.main,borderLeftStyle:"solid",borderLeftWidth:2,marginTop:e.spacing(3),padding:e.spacing(2)},timestamp:{color:e.palette.text.secondary,marginBottom:e.spacing(1)}})}))(_t),Vt=function(e){Object(P.a)(n,e);var t=Object(D.a)(n);function n(){var e;Object(L.a)(this,n);for(var a=arguments.length,r=new Array(a),o=0;o<a;o++)r[o]=arguments[o];return(e=t.call.apply(t,[this].concat(r))).state={result:null,error:null},e}return Object(M.a)(n,[{key:"componentDidMount",value:function(){var e=Object(f.a)(p.a.mark((function e(){var t,n,a,r;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,t=this.props,n=t.nodeIp,a=t.pid,e.next=4,S(n,a);case 4:r=e.sent,this.setState({result:r.logs,error:null}),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(0),this.setState({result:null,error:e.t0.toString()});case 11:case"end":return e.stop()}}),e,this,[[0,8]])})));return function(){return e.apply(this,arguments)}}()},{key:"render",value:function(){var e=this.props,t=e.classes,n=e.clearLogDialog,a=e.nodeIp,o=this.state,c=o.result,l=o.error;return i.a.createElement(Wt,{handleClose:n,title:"Logs"},null!==l?i.a.createElement(h.a,{color:"error"},l):null===c?i.a.createElement(h.a,{color:"textSecondary"},"Loading..."):Object.entries(c).map((function(e){var n=Object(r.a)(e,2),o=n[0],c=n[1];return i.a.createElement(i.a.Fragment,{key:o},i.a.createElement(h.a,{className:t.header},a," (PID: ",o,")"),c.length>0?i.a.createElement("div",{className:t.log},i.a.createElement(Gt,{lines:c})):i.a.createElement(h.a,{color:"textSecondary"},"No logs found."))})))}}]),n}(i.a.Component),qt=Object(W.a)((function(e){return Object(g.a)({header:{lineHeight:1,marginBottom:e.spacing(3),marginTop:e.spacing(3)},log:{backgroundColor:Object(It.c)(e.palette.primary.main,.04),borderLeftColor:e.palette.primary.main,borderLeftStyle:"solid",borderLeftWidth:2,padding:e.spacing(2)}})}))(Vt),Jt={id:"cpu",ClusterFeatureRenderFn:function(e){var t=e.nodes,n=ee(t.map((function(e){return{weight:e.cpus[0],value:e.cpu}})));return i.a.createElement("div",{style:{minWidth:60}},i.a.createElement(ve,{percent:n,text:"".concat(n.toFixed(1),"%")}))},NodeFeatureRenderFn:function(e){var t=e.node;return i.a.createElement("div",{style:{minWidth:60}},i.a.createElement(ve,{percent:t.cpu,text:"".concat(t.cpu.toFixed(1),"%")}))},WorkerFeatureRenderFn:function(e){var t=e.worker;return i.a.createElement("div",{style:{minWidth:60}},i.a.createElement(ve,{percent:t.cpuPercent,text:"".concat(t.cpuPercent.toFixed(1),"%")}))},nodeAccessor:function(e){return e.node.cpu},workerAccessor:function(e){return e.worker.cpuPercent}},Kt={id:"disk",ClusterFeatureRenderFn:function(e){var t,n=e.nodes,a=0,r=0,o=Object($.a)(n);try{for(o.s();!(t=o.n()).done;){var c=t.value;"/"in c.disk&&(a+=c.disk["/"].used,r+=c.disk["/"].total)}}catch(l){o.e(l)}finally{o.f()}return i.a.createElement(ve,{percent:100*a/r,text:nt(a,r,"gibibyte",!0)})},NodeFeatureRenderFn:function(e){var t=e.node;return i.a.createElement(ve,{percent:100*t.disk["/"].used/t.disk["/"].total,text:nt(t.disk["/"].used,t.disk["/"].total,"gibibyte",!0)})},WorkerFeatureRenderFn:function(){return i.a.createElement(h.a,{color:"textSecondary",component:"span",variant:"inherit"},"N/A")},nodeAccessor:function(e){return e.node.disk["/"].used}},Yt=n(2),Xt=function(e){Object(P.a)(n,e);var t=Object(D.a)(n);function n(){return Object(L.a)(this,n),t.apply(this,arguments)}return Object(M.a)(n,[{key:"render",value:function(){var e=this.props,t=e.classes,n=Object(Yt.a)(e,["classes"]);return i.a.createElement("span",Object.assign({className:t.button},n))}}]),n}(i.a.Component),Qt=Object(W.a)((function(e){return Object(g.a)({button:{color:e.palette.primary.main,"&:hover":{cursor:"pointer",textDecoration:"underline"}}})}))(Xt),Zt=function(e){var t=e.nodes,n=te(t.map((function(e){var t;return null!==(t=e.errorCount)&&void 0!==t?t:0})));return 0===n?i.a.createElement(h.a,{color:"textSecondary",component:"span",variant:"inherit"},"No errors"):i.a.createElement(i.a.Fragment,null,n.toLocaleString()," ",1===n?"error":"errors")},$t=function(e){return function(t){var n,a=t.node,r=null!==(n=a.errorCount)&&void 0!==n?n:0;return 0===r?i.a.createElement(h.a,{color:"textSecondary",component:"span",variant:"inherit"},"No errors"):i.a.createElement(Qt,{onClick:function(){return e(a.ip,null)}},"View all errors (",r.toLocaleString(),")")}},en=function(e){var t;return null!==(t=e.node.errorCount)&&void 0!==t?t:0},tn=function(e){return function(t){var n,a=t.node,r=t.worker;return 0!==r.errorCount?i.a.createElement(Qt,{onClick:function(){return e(a.ip,r.pid)}},"View errors (",null===(n=r.errorCount)||void 0===n?void 0:n.toLocaleString(),")"):i.a.createElement(h.a,{color:"textSecondary",component:"span",variant:"inherit"},"No errors")}},nn=function(e){var t;return null!==(t=e.worker.errorCount)&&void 0!==t?t:0},an=function(e){return{id:"errors",ClusterFeatureRenderFn:Zt,WorkerFeatureRenderFn:tn(e),NodeFeatureRenderFn:$t(e),nodeAccessor:en,workerAccessor:nn}},rn=Object(ne.a)(h.a)((function(e){return{paddingRight:e.theme.spacing(1)}})),on=function(e){if(null===e.gpus)return NaN;var t=e.gpus.filter((function(e){return e.utilizationGpu}));return 0===t.length?NaN:te(t.map((function(e){var t;return null!==(t=e.utilizationGpu)&&void 0!==t?t:0})))/t.length},cn=function(e){var t=e.gpu,n=e.slot;return i.a.createElement(U.a,{display:"flex",style:{minWidth:120}},i.a.createElement(me.a,{title:t.name},i.a.createElement(rn,{variant:"body1"},"[",n,"]:")),t.utilizationGpu?i.a.createElement(ve,{percent:t.utilizationGpu,text:"".concat(t.utilizationGpu.toFixed(1),"%")}):i.a.createElement(h.a,{color:"textSecondary",component:"span",variant:"inherit"},"N/A"))},ln=function(e){var t=e.resourceSlot,n=t.allocation,a=t.slot,r=n>=1&&void 0===a?"0":void 0===a?"?":a.toString();return i.a.createElement(h.a,{variant:"body1"},"[",r,"]: ",n)},un={id:"gpu",ClusterFeatureRenderFn:function(e){var t=function(e){var t=e.map((function(e){return{weight:e.gpus.length,value:on(e)}})).filter((function(e){return!isNaN(e.value)}));return 0===t.length?NaN:ee(t)}(e.nodes);return i.a.createElement("div",{style:{minWidth:120}},isNaN(t)?i.a.createElement(h.a,{color:"textSecondary",component:"span",variant:"inherit"},"N/A"):i.a.createElement(ve,{percent:t,text:"".concat(t.toFixed(1),"%")}))},NodeFeatureRenderFn:function(e){var t=e.node,n=void 0!==t.gpus&&0!==t.gpus.length;return i.a.createElement("div",{style:{minWidth:120}},n?t.gpus.map((function(e,t){return i.a.createElement(cn,{gpu:e,slot:t})})):i.a.createElement(h.a,{color:"textSecondary",component:"span",variant:"inherit"},"N/A"))},WorkerFeatureRenderFn:function(e){var t,n,a=null===(t=e.worker.coreWorkerStats[0])||void 0===t?void 0:t.usedResources,r=null===a||void 0===a?void 0:a.GPU;return n=void 0===r?i.a.createElement(h.a,{color:"textSecondary",component:"span",variant:"inherit"},"N/A"):r.resourceSlots.sort((function(e,t){return void 0===e.slot&&void 0===t.slot?0:void 0===e.slot?1:void 0===t.slot?-1:e.slot-t.slot})).map((function(e){return i.a.createElement(ln,{resourceSlot:e})})),i.a.createElement("div",{style:{minWidth:60}},n)},nodeAccessor:function(e){var t=e.node;return on(t)},workerAccessor:function(e){var t;return null!==(t=function(e){var t,n=null===e||void 0===e||null===(t=e.coreWorkerStats[0])||void 0===t?void 0:t.usedResources,a=null===n||void 0===n?void 0:n.GPU;return a&&te(a.resourceSlots.map((function(e){return e.allocation})))}(e.worker))&&void 0!==t?t:0}},sn=function(e){var t=function(e){return e.memoryUsed&&e.memoryTotal?e.memoryUsed/e.memoryTotal:NaN};return 0===e.gpus.map(t).filter((function(e){return!!e})).length?NaN:100*(te(e.gpus.map((function(e){return t(e)})))/e.gpus.length)},mn=function(e){var t=e.gpuName,n=e.slot,a=function(e,t){return"".concat(e," MiB / ").concat(t," MiB")}(e.utilization,e.total);return i.a.createElement(U.a,{display:"flex",style:{minWidth:120}},i.a.createElement(me.a,{title:t},i.a.createElement(rn,{variant:"body1"},"[",n,"]: ",a)))},dn={id:"gram",ClusterFeatureRenderFn:function(e){var t=function(e){var t=e.map((function(e){return{weight:e.gpus.length,value:sn(e)}})).filter((function(e){return!isNaN(e.value)}));return 0===t.length?NaN:ee(t)}(e.nodes);return i.a.createElement("div",{style:{minWidth:60}},isNaN(t)?i.a.createElement(h.a,{color:"textSecondary",component:"span",variant:"inherit"},"N/A"):i.a.createElement(ve,{percent:t,text:"".concat(t.toFixed(1),"%")}))},NodeFeatureRenderFn:function(e){var t=e.node.gpus.map((function(e,t){var n={gpuName:e.name,utilization:e.memoryUsed,total:e.memoryTotal,slot:t};return i.a.createElement(mn,n)}));return i.a.createElement("div",{style:{minWidth:60}},0===t.length?i.a.createElement(h.a,{color:"textSecondary",component:"span",variant:"inherit"},"N/A"):i.a.createElement("div",{style:{minWidth:120}},t))},WorkerFeatureRenderFn:function(e){var t=e.worker,n=e.node.gpus.map((function(e,n){var a=e.processes.find((function(e){return e.pid===t.pid}));if(a){var r={gpuName:e.name,total:e.memoryTotal,utilization:a.gpuMemoryUsage,slot:n};return i.a.createElement(mn,r)}})).filter((function(e){return void 0!==e}));return 0===n.length?i.a.createElement(h.a,{color:"textSecondary",component:"span",variant:"inherit"},"N/A"):i.a.createElement("div",{style:{minWidth:120}},n)},nodeAccessor:function(e){var t=e.node,n=sn(t);return isNaN(n)?-1:n},workerAccessor:function(e){var t=e.worker,n=e.node;return 0===n.gpus.length?-1:function(e,t){var n=t.gpus.map((function(e){return e.processes})).map((function(t){return t.find((function(t){return t.pid===e.pid}))})).map((function(e){return(null===e||void 0===e?void 0:e.gpuMemoryUsage)||0}));return te(n)}(t,n)}},pn={id:"host",ClusterFeatureRenderFn:function(e){var t=e.nodes;return i.a.createElement(i.a.Fragment,null,"Totals (",t.length.toLocaleString()," ",1===t.length?"host":"hosts",")")},NodeFeatureRenderFn:function(e){var t=e.node;return i.a.createElement(i.a.Fragment,null,t.hostname," (",t.ip,")")},WorkerFeatureRenderFn:function(e){var t=e.worker;return i.a.createElement(i.a.Fragment,null,t.cmdline[0].split("::",2)[0]," (PID: ",t.pid,")")},nodeAccessor:function(e){return e.node.hostname}},fn=function(e){var t=e.nodes,n=te(t.map((function(e){var t;return null!==(t=e.logCount)&&void 0!==t?t:0})));return 0===n?i.a.createElement(h.a,{color:"textSecondary",component:"span",variant:"inherit"},"No logs"):i.a.createElement(i.a.Fragment,null,n.toLocaleString()," ",1===n?"line":"lines")},bn=function(e){return function(t){var n,a=t.node,r=null!==(n=a.logCount)&&void 0!==n?n:0;return 0===r?i.a.createElement(h.a,{color:"textSecondary",component:"span",variant:"inherit"},"No logs"):i.a.createElement(Qt,{onClick:function(){return e(a.ip,null)}},"View all logs (",r.toLocaleString()," ",1===a.logCount?"line":"lines",")")}},gn=function(e){var t=e.node;return t.logCount?te(Object.values(t.logCount)):0},hn=function(e){return function(t){var n,a=t.worker,r=t.node,o=null!==(n=a.logCount)&&void 0!==n?n:0;return 0!==o?i.a.createElement(Qt,{onClick:function(){return e(r.ip,a.pid)}},"View log (",o.toLocaleString()," ",1===a.logCount?"line":"lines",")"):i.a.createElement(h.a,{color:"textSecondary",component:"span",variant:"inherit"},"No logs")}},vn=function(e){var t;return null!==(t=e.worker.logCount)&&void 0!==t?t:0},En=function(e){return{id:"logs",ClusterFeatureRenderFn:fn,WorkerFeatureRenderFn:hn(e),NodeFeatureRenderFn:bn(e),workerAccessor:vn,nodeAccessor:gn}},yn={id:"objectStoreMemory",ClusterFeatureRenderFn:function(e){var t=e.nodes,n=te(t.map((function(e){return e.raylet.objectStoreAvailableMemory}))),a=te(t.map((function(e){return e.raylet.objectStoreUsedMemory}))),r=a+n;return i.a.createElement("div",{style:{minWidth:60}},i.a.createElement(ve,{percent:a/r*100,text:nt(a,r,"mebibyte",!1)}))},NodeFeatureRenderFn:function(e){var t=e.node,n=t.raylet.objectStoreAvailableMemory,a=t.raylet.objectStoreUsedMemory,r=n+a;if(void 0===a||void 0===n||0===r)return i.a.createElement(h.a,{color:"textSecondary",component:"span",variant:"inherit"},"N/A");var o=a/r;return i.a.createElement("div",{style:{minWidth:60}},i.a.createElement(ve,{percent:100*o,text:nt(a,r,"mebibyte",!1)}))},WorkerFeatureRenderFn:function(){return i.a.createElement(h.a,{color:"textSecondary",component:"span",variant:"inherit"},"N/A")},nodeAccessor:function(e){return e.node.raylet.objectStoreUsedMemory},workerAccessor:function(){return 0}},jn={id:"ram",ClusterFeatureRenderFn:function(e){var t,n=e.nodes,a=0,r=0,o=Object($.a)(n);try{for(o.s();!(t=o.n()).done;){var c=t.value;a+=c.mem[0]-c.mem[1],r+=c.mem[0]}}catch(l){o.e(l)}finally{o.f()}return i.a.createElement(ve,{percent:100*a/r,text:nt(a,r,"gibibyte",!0)})},NodeFeatureRenderFn:function(e){var t=e.node;return i.a.createElement(ve,{percent:100*(t.mem[0]-t.mem[1])/t.mem[0],text:nt(t.mem[0]-t.mem[1],t.mem[0],"gibibyte",!0)})},WorkerFeatureRenderFn:function(e){var t=e.node,n=e.worker;return i.a.createElement(ve,{percent:100*n.memoryInfo.rss/t.mem[0],text:tt(n.memoryInfo.rss,"mebibyte")})},nodeAccessor:function(e){var t=e.node;return 100*(t.mem[0]-t.mem[1])},workerAccessor:function(e){return e.worker.memoryInfo.rss}},On={id:"received",ClusterFeatureRenderFn:function(e){var t,n=e.nodes,a=0,r=Object($.a)(n);try{for(r.s();!(t=r.n()).done;){a+=t.value.networkSpeed[1]}}catch(o){r.e(o)}finally{r.f()}return i.a.createElement(i.a.Fragment,null,tt(a,"mebibyte"),"/s")},NodeFeatureRenderFn:function(e){var t=e.node;return i.a.createElement(i.a.Fragment,null,tt(t.networkSpeed[1],"mebibyte"),"/s")},WorkerFeatureRenderFn:function(){return i.a.createElement(h.a,{color:"textSecondary",component:"span",variant:"inherit"},"N/A")},nodeAccessor:function(e){return e.node.networkSpeed[1]}},kn={id:"sent",ClusterFeatureRenderFn:function(e){var t,n=e.nodes,a=0,r=Object($.a)(n);try{for(r.s();!(t=r.n()).done;){a+=t.value.networkSpeed[0]}}catch(o){r.e(o)}finally{r.f()}return i.a.createElement(i.a.Fragment,null,tt(a,"mebibyte"),"/s")},NodeFeatureRenderFn:function(e){var t=e.node;return i.a.createElement(i.a.Fragment,null,tt(t.networkSpeed[0],"mebibyte"),"/s")},WorkerFeatureRenderFn:function(){return i.a.createElement(h.a,{color:"textSecondary",component:"span",variant:"inherit"},"N/A")},nodeAccessor:function(e){return e.node.networkSpeed[0]}},xn=function(e){return Date.now()/1e3-e},Cn={id:"uptime",NodeFeatureRenderFn:function(e){var t=e.node;return i.a.createElement(i.a.Fragment,null,at(xn(t.bootTime)))},WorkerFeatureRenderFn:function(e){var t=e.worker;return i.a.createElement(i.a.Fragment,null,at(xn(t.createTime)))},nodeAccessor:function(e){var t=e.node;return xn(t.bootTime)},workerAccessor:function(e){var t=e.worker;return xn(t.createTime)}},Sn={id:"workers",ClusterFeatureRenderFn:function(e){var t,n=e.nodes,a=0,r=0,o=Object($.a)(n);try{for(o.s();!(t=o.n()).done;){var c=t.value;a+=c.cpus[0],r+=c.workers.length}}catch(l){o.e(l)}finally{o.f()}return i.a.createElement(i.a.Fragment,null,r.toLocaleString()," ",1===r?"worker":"workers"," / ",a.toLocaleString()," ",1===a?"core":"cores")},NodeFeatureRenderFn:function(e){var t=e.node,n=t.cpus[0],a=t.workers.length;return i.a.createElement(i.a.Fragment,null,a.toLocaleString()," ",1===a?"worker":"workers"," / ",n.toLocaleString()," ",1===n?"core":"cores")},WorkerFeatureRenderFn:function(e){var t=e.worker;return i.a.createElement(i.a.Fragment,null,t.cmdline[0].split("::",2)[1])}},Nn=n(122),wn=n.n(Nn),Tn=n(123),Fn=n.n(Tn),Rn=function(e){var t=e.features,n=e.data,a=n.node,r=n.worker;return i.a.createElement(st.a,{hover:!0},i.a.createElement(pt,null),t.map((function(e,t){return i.a.createElement(pt,{key:t},i.a.createElement(e,{node:a,worker:r}))})))},In=Object(b.a)((function(e){return Object(g.a)({cell:{padding:e.spacing(1),textAlign:"center","&:last-child":{paddingRight:e.spacing(1)}},expandCollapseCell:{cursor:"pointer"},expandCollapseIcon:{color:e.palette.text.secondary,fontSize:"1.5em",verticalAlign:"middle"},extraInfo:{fontFamily:"SFMono-Regular,Consolas,Liberation Mono,Menlo,monospace",whiteSpace:"pre"}})})),An=function(e){var t=e.features,n=e.node,a=e.initialExpanded,o=e.rayletInfo,c=e.workerFeatureData,u=Object(l.useState)(a),s=Object(r.a)(u,2),m=s[0],d=s[1],p=In(),f=t.map((function(e,t){var a=e.NodeFeatureRenderFn;return i.a.createElement(pt,{className:p.cell,key:t},i.a.createElement(a,{node:n}))}));return i.a.createElement(i.a.Fragment,null,i.a.createElement(st.a,{hover:!0},i.a.createElement(dt.a,{className:Bt()(p.cell,p.expandCollapseCell),onClick:function(){return d(!m)}},m?i.a.createElement(Fn.a,{className:p.expandCollapseIcon}):i.a.createElement(wn.a,{className:p.expandCollapseIcon})),f),m&&i.a.createElement(i.a.Fragment,null,void 0!==o&&i.a.createElement(st.a,{hover:!0},i.a.createElement(dt.a,{className:p.cell}),i.a.createElement(dt.a,{className:Bt()(p.cell,p.extraInfo),colSpan:t.length},o)),c.map((function(e,n){return i.a.createElement(Rn,{key:n,features:t.map((function(e){return e.WorkerFeatureRenderFn})),data:e})}))))},Ln=n(124),Mn=n.n(Ln),Pn=Object(b.a)((function(e){return Object(g.a)({cell:{borderTopColor:e.palette.divider,borderTopStyle:"solid",borderTopWidth:2,padding:e.spacing(1),textAlign:"center","&:last-child":{paddingRight:e.spacing(1)}},totalIcon:{color:e.palette.text.secondary,fontSize:"1.5em",verticalAlign:"middle"}})})),Dn=function(e){var t=e.nodes,n=e.features,a=Pn();return i.a.createElement(st.a,{hover:!0},i.a.createElement(dt.a,{className:a.cell},i.a.createElement(Mn.a,{className:a.totalIcon})),n.map((function(e,n){return e?i.a.createElement(dt.a,{className:a.cell,key:n},i.a.createElement(e,{nodes:t})):i.a.createElement(pt,{key:n})})))},Wn=function(e,t){var n=e.sort((function(e,t){var n=e.worker,a=t.worker;return"ray::IDLE"===a.cmdline[0]?-1:"ray::IDLE"===n.cmdline[0]?1:n.pid<a.pid?-1:1}));return t?Z(n,t):n},zn=Object(b.a)((function(e){return Object(g.a)({table:{marginTop:e.spacing(1)},cell:{padding:e.spacing(1),textAlign:"center","&:last-child":{paddingRight:e.spacing(1)}}})})),Bn=function(e){var t,n;return null===(t=e.dashboard)||void 0===t||null===(n=t.nodeInfo)||void 0===n?void 0:n.clients.filter((function(e){return"ALIVE"===e.raylet.state}))},Un=[{id:"host",label:"Host",numeric:!0,sortable:!0},{id:"workers",label:"PID",numeric:!0,sortable:!1},{id:"uptime",label:"Uptime (s)",numeric:!0,sortable:!0},{id:"cpu",label:"CPU",numeric:!1,sortable:!0},{id:"ram",label:"RAM",numeric:!0,sortable:!0},{id:"gpu",label:"GPU",numeric:!0,sortable:!0},{id:"gram",label:"GRAM",numeric:!0,sortable:!0},{id:"objectStoreMemory",label:"Plasma",numeric:!1,sortable:!0},{id:"disk",label:"Disk",numeric:!0,sortable:!0},{id:"sent",label:"Sent",numeric:!0,sortable:!0},{id:"received",label:"Received",numeric:!1,sortable:!0},{id:"logs",label:"Logs",numeric:!1,sortable:!0},{id:"errors",label:"Errors",numeric:!1,sortable:!0}],Gn=function(){var e,t,n=Object(l.useState)(null),a=Object(r.a)(n,2),o=a[0],c=a[1],s=Object(l.useState)(null),m=Object(r.a)(s,2),d=m[0],p=m[1],f=Object(l.useState)(!0),b=Object(r.a)(f,2),g=b[0],v=b[1],E=i.a.useState("asc"),y=Object(r.a)(E,2),j=y[0],O=y[1],k=i.a.useState(null),x=Object(r.a)(k,2),C=x[0],S=x[1],N=zn(),w=Object(u.d)(Bn);if(!w)return i.a.createElement(h.a,{color:"textSecondary"},"Loading...");var T=te(w.map((function(e){return e.workers.length}))),F=[pn,Sn,Cn,Jt,jn,un,dn,yn,Kt,kn,On,En((function(e,t){return c({nodeIp:e,pid:t})})),an((function(e,t){return p({nodeIp:e,pid:t})}))],R=null===(e=F.find((function(e){return e.id===C})))||void 0===e?void 0:e.nodeAccessor,I=R&&Q(j,R),A=null===(t=F.find((function(e){return e.id===C})))||void 0===t?void 0:t.workerAccessor,L=A&&Q(j,A),M=0!==w.map((function(e){return e.gpus})).filter((function(e){return 0!==e.length})).length,P=0!==w.filter((function(e){return e.disk["/"].total>10})).length,D=function(e){return(M||"gpu"!==e.id&&"gram"!==e.id)&&(P||"disk"!==e.id)},W=F.filter(D),z=Un.filter(D),B=g?function(e,t,n,a){return(n?Z(e,n):e).map((function(n){var r=n.workers.map((function(e){return{node:n,worker:e}})),o=Wn(r,t);return i.a.createElement(An,{key:n.raylet.nodeId,node:n,workerFeatureData:o,features:a,initialExpanded:e.length<=1})}))}(w,L,I,W):function(e,t,n){var a=n.map((function(e){return e.WorkerFeatureRenderFn})),r=e.flatMap((function(e){return e.workers.map((function(t){return{node:e,worker:t}}))}));return Wn(r,t).map((function(e,t){return i.a.createElement(Rn,{features:a,data:e,key:"worker-".concat(t)})}))}(w,L,W);return i.a.createElement(i.a.Fragment,null,i.a.createElement(Ft.a,{control:i.a.createElement(Rt.a,{checked:g,onChange:function(){return v(!g)},color:"primary"}),label:"Group by host"}),i.a.createElement(lt.a,{className:N.table},i.a.createElement(bt,{onRequestSort:function(e,t){t===C?O("asc"===j?"desc":"asc"):(S(t),O("asc"))},headerInfo:z,order:j,orderBy:C,firstColumnEmpty:!0}),i.a.createElement(it.a,null,B,i.a.createElement(Dn,{clusterTotalWorkers:T,nodes:w,features:W.map((function(e){return e.ClusterFeatureRenderFn}))}))),null!==o&&i.a.createElement(qt,{clearLogDialog:function(){return c(null)},nodeIp:o.nodeIp,pid:o.pid}),null!==d&&i.a.createElement(Ht,{clearErrorDialog:function(){return p(null)},nodeIp:d.nodeIp,pid:d.pid}))},_n=Object(b.a)((function(e){return Object(g.a)({table:{marginTop:e.spacing(1),width:"auto"},cell:{paddingTop:e.spacing(1),paddingBottom:e.spacing(1),paddingLeft:e.spacing(3),paddingRight:e.spacing(3),textAlign:"center","&:last-child":{paddingRight:e.spacing(3)}},key:{color:e.palette.text.secondary}})})),Hn=$e.setRayConfig,Vn=$e.setError,qn=function(e){return e.dashboard.rayConfig},Jn=function(){var e=_n(),t=Object(u.d)(qn),n=Object(u.c)(),a=Object(l.useCallback)(Object(f.a)(p.a.mark((function e(){var t;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,O("/api/ray_config",{});case 3:t=e.sent,n(Hn(t)),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),n(Vn(e.t0.toString()));case 10:case"end":return e.stop()}}),e,null,[[0,7]])}))),[n]),r=Object(l.useRef)(null);if(Object(l.useEffect)((function(){null===r.current&&(a(),r.current=setInterval(a,1e4));return function(){clearInterval(r.current)}}),[a]),null===t)return i.a.createElement(h.a,{color:"textSecondary"},"No Ray configuration detected.");var o=[{key:"Autoscaling mode",value:t.autoscalingMode},{key:"Head node type",value:t.headType},{key:"Worker node type",value:t.workerType},{key:"Min worker nodes",value:t.minWorkers},{key:"Initial worker nodes",value:t.initialWorkers},{key:"Max worker nodes",value:t.maxWorkers},{key:"Idle timeout",value:"".concat(t.idleTimeoutMinutes," ").concat(1===t.idleTimeoutMinutes?"minute":"minutes")}];return i.a.createElement("div",null,i.a.createElement(h.a,null,"Ray cluster configuration:"),i.a.createElement(lt.a,{className:e.table},i.a.createElement(ut.a,null,i.a.createElement(st.a,null,i.a.createElement(dt.a,{className:e.cell},"Setting"),i.a.createElement(dt.a,{className:e.cell},"Value"))),i.a.createElement(it.a,null,o.map((function(t,n){var a=t.key,r=t.value;return i.a.createElement(st.a,{key:n},i.a.createElement(dt.a,{className:Bt()(e.cell,e.key)},a),i.a.createElement(dt.a,{className:e.cell},r))})))))},Kn=n(240),Yn=n(238),Xn=$e,Qn=function(e){Object(P.a)(n,e);var t=Object(D.a)(n);function n(){var e;Object(L.a)(this,n);for(var a=arguments.length,r=new Array(a),o=0;o<a;o++)r[o]=arguments[o];return(e=t.call.apply(t,[this].concat(r))).state={currentError:"",open:!1},e.handleOpen=function(t){e.setState({open:!0,currentError:t})},e.handleClose=function(){e.setState({open:!1})},e}return Object(M.a)(n,[{key:"render",value:function(){var e=this,t=this.props,n=t.classes,a=t.tuneInfo,r=this.state,o=r.currentError,c=r.open;return null===a||0===Object.keys(a.errors).length?null:i.a.createElement(i.a.Fragment,null,i.a.createElement(lt.a,{className:n.table},i.a.createElement(ut.a,null,i.a.createElement(st.a,null,i.a.createElement(dt.a,{className:n.cell}," Job ID"),i.a.createElement(dt.a,{className:n.cell}," Trial ID "),i.a.createElement(dt.a,{className:n.cell}," Trial Directory "),i.a.createElement(dt.a,{className:n.cell}," Error "))),i.a.createElement(it.a,null,null!==a.errors&&Object.keys(a.errors).map((function(t,r){return i.a.createElement(st.a,{key:r},i.a.createElement(dt.a,{className:n.cell},a.errors[t].jobId),i.a.createElement(dt.a,{className:n.cell},a.errors[t].trialId),i.a.createElement(dt.a,{className:n.cell},t),i.a.createElement(dt.a,{className:n.cell},i.a.createElement(Yn.a,{component:"button",variant:"body2",onClick:function(){e.handleOpen(t)}},"Show Error")))})))),c&&i.a.createElement(Wt,{handleClose:this.handleClose,title:"Error Log"},c&&i.a.createElement(Gt,{lines:a.errors[o].text.trim().split("\n")})))}}]),n}(i.a.Component),Zn=Object(u.b)((function(e){return{tuneInfo:e.dashboard.tuneInfo}}),Xn)(Object(W.a)((function(e){return Object(g.a)({table:{marginTop:e.spacing(1)},cell:{padding:e.spacing(1),textAlign:"center","&:last-child":{paddingRight:e.spacing(1)}}})}))(Qn)),$n=n(184),ea=n(239),ta=$e,na=function(e){Object(P.a)(n,e);var t=Object(D.a)(n);function n(){var e;Object(L.a)(this,n);for(var a=arguments.length,r=new Array(a),o=0;o<a;o++)r[o]=arguments[o];return(e=t.call.apply(t,[this].concat(r))).timeout=0,e.state={sortedColumn:void 0,ascending:!0,metricParamColumn:"",metricColumns:[],paramColumns:[],errorTrial:"",open:!1},e.onColumnClick=function(t,n){var a=e.state.ascending;a=t!==e.state.sortedColumn||!a,e.setState({sortedColumn:t,ascending:a}),n&&e.setState({metricParamColumn:n})},e.humanize=function(e){return e.split("_").map((function(e){return e.charAt(0).toUpperCase()+e.slice(1)})).join(" ")},e.handleOpen=function(t){"number"===typeof t&&(t=t.toString()),e.setState({open:!0,errorTrial:t})},e.handleClose=function(){e.setState({open:!1})},e.sortedCell=function(t,n,a){var r=e.props,o=r.tuneInfo,c=r.classes,l=e.state,u=l.sortedColumn,s=l.ascending,m=l.metricParamColumn,d="asc";if(t!==u||s||(d="desc"),null!==o){var p=function(){return e.onColumnClick(t)};n&&(p=function(){return e.onColumnClick(t,n)}),a||(a=0);var f=!1,b=t+a.toString();return n?(b=n+a.toString(),f=n===m&&u===t):f=t===u,i.a.createElement(dt.a,{className:c.cell,key:b,onClick:p},i.a.createElement(mt.a,{active:f,direction:d}),n?e.humanize(n):e.humanize(t))}},e.sortedTrialRecords=function(){var t=e.props.tuneInfo,n=e.state,a=n.sortedColumn,r=n.ascending,o=n.metricParamColumn;if(null===t||0===Object.keys(t.trialRecords).length)return null;var c=Object.values(t.trialRecords);if(!a)return c;var l=function(e){return e[a]};return"metrics"!==a&&"params"!==a||(l=function(e){return e[a][o]}),a&&(r?c.sort((function(e,t){return l(e)>l(t)?1:-1})):r||c.sort((function(e,t){return l(e)<l(t)?1:-1}))),c},e.handleMetricChoiceChange=function(t){return function(n){var a=e.state.metricColumns;n.target.checked?(a.push(t),e.setState({metricColumns:a})):(a=a.filter((function(e){return e!==t})),e.setState({metricColumns:a}))}},e.metricChoices=function(t){var n=e.state.metricColumns;return i.a.createElement(G.a,null,i.a.createElement($n.a,{component:"legend"},"Select Metrics "),i.a.createElement(ea.a,null,t.map((function(t){return i.a.createElement(Ft.a,{control:i.a.createElement(Rt.a,{checked:n.includes(t),onChange:e.handleMetricChoiceChange(t),value:t,color:"primary"}),label:t})}))))},e.handleParamChoiceChange=function(t){return function(n){var a=e.state.paramColumns;n.target.checked?(a.push(t),e.setState({paramColumns:a})):(a=a.filter((function(e){return e!==t})),e.setState({paramColumns:a}))}},e.paramChoices=function(t){var n=e.props.classes,a=e.state.paramColumns;return i.a.createElement(G.a,{className:n.paramChecklist},i.a.createElement($n.a,{component:"legend"},"Select Parameters "),i.a.createElement(ea.a,null,t.map((function(t){return i.a.createElement(Ft.a,{control:i.a.createElement(Rt.a,{checked:a.includes(t),onChange:e.handleParamChoiceChange(t),value:t,color:"primary"}),label:t})}))))},e}return Object(M.a)(n,[{key:"render",value:function(){var e=this,t=this.props,n=t.classes,a=t.tuneInfo,r=this.state,o=r.metricColumns,c=r.paramColumns,l=r.open,u=r.errorTrial;if(null===a||0===Object.keys(a.trialRecords).length)return null;var s=Object.keys(a.trialRecords)[0],m=a.trialRecords[s].params,d=Object.keys(m).filter((function(e){return"args"!==e})),p=d,f=d.length>3;f&&(0===c.length&&this.setState({paramColumns:d.slice(0,3)}),p=c);var b=Object.keys(a.trialRecords[s].metrics),g=b,h=b.length>3;h&&(0===o.length&&this.setState({metricColumns:b.slice(0,3)}),g=o);var v=this.sortedTrialRecords();return i.a.createElement("div",{className:n.root},i.a.createElement(re.a,{container:!0,spacing:0},(f||h)&&i.a.createElement(re.a,{item:!0,xs:2,className:n.checkboxRoot},f&&this.paramChoices(d),h&&this.metricChoices(b)),i.a.createElement(re.a,{item:!0,xs:f||h?10:12,className:n.table},i.a.createElement(lt.a,{stickyHeader:!0},i.a.createElement(ut.a,null,i.a.createElement(st.a,null,this.sortedCell("trialId"),this.sortedCell("jobId"),this.sortedCell("startTime"),p.map((function(t,n){return e.sortedCell("params",t,n)})),this.sortedCell("status"),g.map((function(t,n){return e.sortedCell("metrics",t,n)})),i.a.createElement(dt.a,{className:n.cell,key:"error"},"Error"))),i.a.createElement(it.a,null,null!==v&&v.map((function(t,a){return i.a.createElement(st.a,{key:a},i.a.createElement(dt.a,{className:n.cell},t.trialId),i.a.createElement(dt.a,{className:n.cell},t.jobId),i.a.createElement(dt.a,{className:n.cell},t.startTime),p.map((function(e,a){return i.a.createElement(dt.a,{className:n.cell,key:a},"number"===typeof t.params[e]?rt(Number(t.params[e])):t.params[e])})),i.a.createElement(dt.a,{className:n.cell},t.status),t.metrics&&g.map((function(e,a){return i.a.createElement(dt.a,{className:n.cell,key:a},"number"===typeof t.metrics[e]?rt(Number(t.metrics[e])):t.metrics[e])})),i.a.createElement(dt.a,{className:n.cell},"No Error"===t.error?"No Error":i.a.createElement(Yn.a,{component:"button",variant:"body2",onClick:function(){e.handleOpen(t.trialId)}},"Show Error")))})))))),l&&i.a.createElement(Wt,{handleClose:this.handleClose,title:"Error Log"},l&&i.a.createElement(Gt,{lines:a.trialRecords[u].error.trim().split("\n")})))}}]),n}(i.a.Component),aa=Object(u.b)((function(e){return{tuneInfo:e.dashboard.tuneInfo}}),ta)(Object(W.a)((function(e){return Object(g.a)({root:{padding:e.spacing(2),"& > :not(:first-child)":{marginTop:e.spacing(2)}},table:{marginTop:e.spacing(1),height:"700px",overflowY:"auto"},cell:{padding:e.spacing(1),textAlign:"right","&:last-child":{paddingRight:e.spacing(1)}},checkboxRoot:{height:"500px",overflowY:"auto",overflowX:"auto"},paramChecklist:{marginBottom:e.spacing(2)}})}))(na)),ra=$e,oa=function(e){Object(P.a)(n,e);var t=Object(D.a)(n);function n(){var e;Object(L.a)(this,n);for(var a=arguments.length,r=new Array(a),o=0;o<a;o++)r[o]=arguments[o];return(e=t.call.apply(t,[this].concat(r))).state={tensorBoardEnabled:!1,loading:!1},e.handleSubmit=function(){e.setState({loading:!0}),R().then((function(){e.setState({loading:!1})}))},e.tensorBoard=function(){var t=e.props,n=t.classes,a=t.error,r=t.tuneInfo;return i.a.createElement("div",null,"TypeError: Failed to fetch"===a&&i.a.createElement(h.a,{className:n.warning,color:"textSecondary"},'Warning: Tensorboard server closed. View Tensorboard by running "tensorboard --logdir" if not displaying below.'),r&&!r.tensorboard.tensorboardCurrent&&i.a.createElement(h.a,{className:n.warning,color:"textSecondary"},"The below Tensorboard reflects a previously entered log directory. Restart the Ray Dashboard to change the Tensorboard logdir."),i.a.createElement("iframe",{src:"http://localhost:6006/",className:n.board,title:"TensorBoard"}))},e}return Object(M.a)(n,[{key:"enableTensorBoard",value:function(){R(),this.setState({tensorBoardEnabled:!0})}},{key:"render",value:function(){var e=this.props,t=e.classes,n=e.tuneInfo,a=this.state.loading;if(null!==n){var r=n.tensorboard.tensorboardEnabled;return i.a.createElement("div",{className:t.root},!r&&i.a.createElement("div",null,i.a.createElement(v.a,{variant:"outlined",onClick:this.handleSubmit,className:t.warning},"Enable TensorBoard"),a&&i.a.createElement(Ge.a,{className:t.progress,size:25})),r&&this.tensorBoard())}}}]),n}(i.a.Component),ca=Object(u.b)((function(e){return{error:e.dashboard.error,tuneInfo:e.dashboard.tuneInfo}}),ra)(Object(W.a)((function(e){return Object(g.a)({root:{backgroundColor:e.palette.background.paper,padding:e.spacing(2),"& > :not(:first-child)":{marginTop:e.spacing(4)}},board:{width:"100%",height:"1000px",border:"none"},warning:{fontSize:"0.8125rem"},progress:{marginLeft:"10px",marginTop:"2px"}})}))(oa)),la=$e,ia=function(e){Object(P.a)(n,e);var t=Object(D.a)(n);function n(){var e;Object(L.a)(this,n);for(var a=arguments.length,r=new Array(a),o=0;o<a;o++)r[o]=arguments[o];return(e=t.call.apply(t,[this].concat(r))).timeout=0,e.state={tabIndex:0,experiment:"",loading:!1},e.refreshTuneInfo=Object(f.a)(p.a.mark((function t(){var n;return p.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(t.prev=0,!e.props.tuneAvailability||!e.props.tuneAvailability.available){t.next=6;break}return t.next=4,T();case 4:n=t.sent,e.props.setTuneInfo(n);case 6:t.next=11;break;case 8:t.prev=8,t.t0=t.catch(0),e.props.setError(t.t0.toString());case 11:return t.prev=11,e.timeout=window.setTimeout(e.refreshTuneInfo,1e3),t.finish(11);case 14:case"end":return t.stop()}}),t,null,[[0,8,11,14]])}))),e.handleTabChange=function(t,n){e.setState({tabIndex:n})},e.handleExperimentChange=function(t){e.setState({experiment:t.target.value})},e.handleExperimentSubmit=Object(f.a)(p.a.mark((function t(){return p.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e.setState({loading:!0}),t.prev=1,t.next=4,F(e.state.experiment);case 4:return window.clearTimeout(e.timeout),t.next=7,e.refreshTuneInfo();case 7:e.setState({loading:!1}),t.next=14;break;case 10:t.prev=10,t.t0=t.catch(1),e.props.setError(t.t0.toString()),e.setState({loading:!1});case 14:case"end":return t.stop()}}),t,null,[[1,10]])}))),e.experimentChoice=function(t){var n=e.props.classes,a=e.state.loading;return i.a.createElement("div",null,t&&i.a.createElement(h.a,{className:n.heading,color:"textPrimary"},"You can use this tab to monitor Tune jobs, their statuses, hyperparameters, and more. For more information, read the documentation"," ",i.a.createElement("a",{href:"https://docs.ray.io/en/master/ray-dashboard.html#tune"},"here"),"."),i.a.createElement("div",null,i.a.createElement(h.a,{className:n.prompt,color:"textSecondary"},"Enter Tune Log Directory Here:"),i.a.createElement(Kn.a,{className:n.input,id:"standard-basic",value:e.state.experiment,onChange:e.handleExperimentChange}),i.a.createElement(v.a,{className:n.submit,variant:"outlined",onClick:e.handleExperimentSubmit},"Submit"),a&&i.a.createElement(Ge.a,{className:n.progress,size:25})))},e}return Object(M.a)(n,[{key:"componentWillUnmount",value:function(){var e=Object(f.a)(p.a.mark((function e(){return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:window.clearTimeout(this.timeout);case 1:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"render",value:function(){var e=this.props,t=e.classes,n=e.tuneInfo,a=e.tuneAvailability;if(a&&!a.trialsAvailable)return this.experimentChoice(!0);var r=this.state.tabIndex,o=[{label:"Table",component:aa},{label:"TensorBoard",component:ca}];null!==n&&Object.keys(n.errors).length>0&&o.push({label:"Errors",component:Zn});var c=o[r].component;return i.a.createElement("div",{className:t.root},this.experimentChoice(!1),i.a.createElement(E.a,{className:t.tabs,indicatorColor:"primary",onChange:this.handleTabChange,textColor:"primary",value:r},o.map((function(e){var t=e.label;return i.a.createElement(y.a,{key:t,label:t})}))),i.a.createElement(c,null))}}]),n}(i.a.Component),ua=Object(u.b)((function(e){return{tuneInfo:e.dashboard.tuneInfo,tuneAvailability:e.dashboard.tuneAvailability}}),la)(Object(W.a)((function(e){return Object(g.a)({root:{backgroundColor:e.palette.background.paper},tabs:{borderBottomColor:e.palette.divider,borderBottomStyle:"solid",borderBottomWidth:1},heading:{fontsize:"0.9em",marginTop:e.spacing(2)},warning:{fontSize:"1em"},warningIcon:{fontSize:"1.25em",verticalAlign:"text-bottom"},formControl:{margin:e.spacing(1),minWidth:120},submit:{marginLeft:e.spacing(2),fontSize:"0.8125em"},prompt:{fontSize:"1em",marginTop:e.spacing(1)},input:{width:"85%"},progress:{marginLeft:e.spacing(2)}})}))(ia)),sa=$e.setNodeInfo,ma=$e.setTuneAvailability,da=$e.setActorGroups,pa=$e.setError,fa=$e.setTab,ba=Object(b.a)((function(e){return Object(g.a)({root:{backgroundColor:e.palette.background.paper,padding:e.spacing(2),"& > :not(:first-child)":{marginTop:e.spacing(4)},position:"relative"},tabs:{borderBottomColor:e.palette.divider,borderBottomStyle:"solid",borderBottomWidth:1}})})),ga=function(e){return e.dashboard.tab},ha=function(e){return e.dashboard.tuneAvailability},va=[{label:"Machine view",component:Gn},{label:"Logical view",component:Ue},{label:"Memory",component:Tt},{label:"Ray config",component:Jn},{label:"Tune",component:ua}],Ea=function(){var e=Object(u.c)(),t=Object(u.d)(ha),n=Object(u.d)(ga),a=ba(),o=Object(m.f)(),c=Object(l.useCallback)(Object(f.a)(p.a.mark((function t(){var n,a,o,c,l;return p.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,Promise.all([O("/nodes",{view:"details"}),O("/tune/availability",{}),O("logical/actor_groups",{})]);case 3:n=t.sent,a=Object(r.a)(n,3),o=a[0],c=a[1],l=a[2],e(sa({nodeInfo:o})),e(ma(c)),e(da(l)),e(pa(null)),t.next=17;break;case 14:t.prev=14,t.t0=t.catch(0),e(pa(t.t0.toString()));case 17:case"end":return t.stop()}}),t,null,[[0,14]])}))),[e]),s=Object(l.useRef)(null);Object(l.useEffect)((function(){null===s.current&&(c(),s.current=setInterval(c,1e3));return function(){clearInterval(s.current)}}),[c]);var d=va.slice();null!==t&&t.available||d.splice(4);var b=d[n].component;return i.a.createElement("div",{className:a.root},i.a.createElement(h.a,{variant:"h5"},"Ray Dashboard"),i.a.createElement(v.a,{style:{position:"absolute",right:16,top:16},variant:"contained",size:"small",color:"primary",onClick:function(){return o.push("/node")}},"Try Experimental Dashboard"),i.a.createElement(E.a,{className:a.tabs,indicatorColor:"primary",onChange:function(t,n){return e(fa(n))},textColor:"primary",value:n},d.map((function(e){var t=e.label;return i.a.createElement(y.a,{key:t,label:t})}))),i.a.createElement(b,null),i.a.createElement(B,null))},ya=n(109),ja=n.n(ya),Oa=function(){return i.a.createElement("div",{style:{height:"100vh",width:"100vw"}},i.a.createElement("div",{style:{margin:"250px auto 0 auto",textAlign:"center",fontSize:40,fontWeight:500}},i.a.createElement("img",{src:ja.a,alt:"Loading",width:100}),i.a.createElement("br",null),"Loading..."))},ka=n(92),xa=Object(Qe.a)({reducer:{dashboard:et},devTools:!1}),Ca=n(78),Sa=n(242),Na=n(75),wa=n(243),Ta=n(126),Fa={typography:{fontSize:12,fontFamily:["-apple-system","BlinkMacSystemFont",'"Segoe UI"',"Roboto",'"Helvetica Neue"',"Arial","sans-serif",'"Apple Color Emoji"','"Segoe UI Emoji"','"Segoe UI Symbol"'].join(",")},props:{MuiPaper:{elevation:0}}},Ra=Object(Ta.a)(Object(be.a)(Object(be.a)({},Fa),{},{palette:{primary:Ca.a,secondary:Sa.a,text:{primary:Na.a[900],secondary:Na.a[800],disabled:Na.a[400],hint:Na.a[300]},background:{paper:"#fff",default:wa.a[50]}}})),Ia=Object(Ta.a)(Object(be.a)(Object(be.a)({},Fa),{},{palette:{primary:Ca.a,secondary:Sa.a,text:{primary:wa.a[50],secondary:wa.a[100],disabled:wa.a[200],hint:wa.a[300]},background:{paper:Na.a[800],default:Na.a[900]}}})),Aa=i.a.lazy((function(){return Promise.all([n.e(0),n.e(1),n.e(2),n.e(10)]).then(n.bind(null,517))})),La=i.a.lazy((function(){return Promise.all([n.e(3),n.e(12)]).then(n.bind(null,518))})),Ma=i.a.lazy((function(){return n.e(14).then(n.bind(null,519))})),Pa=i.a.lazy((function(){return Promise.all([n.e(0),n.e(13)]).then(n.bind(null,520))})),Da=i.a.lazy((function(){return Promise.all([n.e(0),n.e(1),n.e(2),n.e(7)]).then(n.bind(null,521))})),Wa=i.a.lazy((function(){return n.e(15).then(n.bind(null,512))})),za=i.a.lazy((function(){return Promise.all([n.e(3),n.e(8)]).then(n.bind(null,515))})),Ba=i.a.lazy((function(){return Promise.all([n.e(0),n.e(1),n.e(11)]).then(n.bind(null,516))})),Ua=i.a.lazy((function(){return Promise.all([n.e(0),n.e(1),n.e(2),n.e(9)]).then(n.bind(null,522))})),Ga=i.a.createContext({nodeMap:{},ipLogMap:{},namespaceMap:{}}),_a=function(){return function(e){var t=window.localStorage.getItem(e);try{return JSON.parse(t||"")}catch(n){return t}}("ray-dashboard-theme")||"light"},Ha=function(e){return t="ray-dashboard-theme",n=e,window.localStorage.setItem(t,JSON.stringify(n));var t,n};t.b=function(){var e=Object(l.useState)(_a()),t=Object(r.a)(e,2),n=t[0],a=t[1],d=Object(l.useState)({nodeMap:{},ipLogMap:{},namespaceMap:{}}),p=Object(r.a)(d,2),f=p[0],b=p[1],g=function(e){Ha(e),a(e)};return Object(l.useEffect)((function(){Object(ka.b)().then((function(e){var t,n;if(null===e||void 0===e||null===(t=e.data)||void 0===t||null===(n=t.data)||void 0===n?void 0:n.summary){var a={},r={};e.data.data.summary.forEach((function(e){var t=e.hostname,n=e.raylet,o=e.ip,c=e.logUrl;a[t]=n.nodeId,r[o]=c})),b({nodeMap:a,ipLogMap:r,namespaceMap:{}})}}))}),[]),i.a.createElement(c.a,{theme:function(e){switch(e){case"dark":return Ia;case"light":default:return Ra}}(n)},i.a.createElement(l.Suspense,{fallback:Oa},i.a.createElement(Ga.Provider,{value:f},i.a.createElement(u.a,{store:xa},i.a.createElement(o.a,null),i.a.createElement(s.a,null,i.a.createElement(m.c,null,i.a.createElement(m.a,{component:Ea,exact:!0,path:"/"}),i.a.createElement(m.a,{render:function(e){return i.a.createElement(Wa,Object.assign({},e,{setTheme:g,theme:n}),i.a.createElement(m.a,{component:Ma,exact:!0,path:"/summary"}),i.a.createElement(m.a,{component:Pa,exact:!0,path:"/job"}),i.a.createElement(m.a,{component:Ba,exact:!0,path:"/node"}),i.a.createElement(m.a,{component:Aa,exact:!0,path:"/actors"}),i.a.createElement(m.a,{render:function(e){return i.a.createElement(za,Object.assign({},e,{theme:n}))},exact:!0,path:"/log/:host?/:path?"}),i.a.createElement(m.a,{component:Ua,path:"/node/:id"}),i.a.createElement(m.a,{component:Da,path:"/job/:id"}),i.a.createElement(m.a,{component:La,path:"/cmd/:cmd/:ip/:pid"}),i.a.createElement(m.a,{component:Oa,exact:!0,path:"/loading"}))}})))))))}},92:function(e,t,n){"use strict";n.d(t,"b",(function(){return l})),n.d(t,"a",(function(){return i}));var a=n(12),r=n.n(a),o=n(17),c=n(53),l=function(){var e=Object(o.a)(r.a.mark((function e(){return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(c.b)("nodes?view=summary");case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),i=function(){var e=Object(o.a)(r.a.mark((function e(t){return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(c.b)("nodes/".concat(t));case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()}},[[145,5,6]]]);
//# sourceMappingURL=main.74f85e03.chunk.js.map